<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸ¦… GARUDA - Asset Details: {{ asset.name }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .eagle-header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 20px 0;
            margin-bottom: 30px;
        }

        .priority-high {
            color: #dc3545;
        }

        .priority-medium {
            color: #fd7e14;
        }

        .priority-low {
            color: #28a745;
        }

        .detail-card {
            border: none;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .asset-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            margin-right: 20px;
        }

        .type-bridge {
            background: #17a2b8;
        }

        .type-tunnel {
            background: #6f42c1;
        }

        .type-airport {
            background: #20c997;
        }

        .type-railway {
            background: #fd7e14;
        }

        .type-port {
            background: #6610f2;
        }

        .type-power {
            background: #e83e8c;
        }

        .type-default {
            background: #6c757d;
        }
    </style>
</head>

<body class="bg-light">
    <div class="eagle-header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1 class="mb-1">
                        <i class="fas fa-eye"></i> GARUDA
                    </h1>
                    <p class="mb-0">Asset Detail View</p>
                </div>
                <div class="col-md-4 text-end">
                    <a href="/" class="btn btn-light btn-sm">
                        <i class="fas fa-arrow-left"></i> Back to Dashboard
                    </a>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Asset Header -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="detail-card card">
                    <div class="card-body">
                        <div class="row align-items-center">
                            <div class="col-auto">
                                <div class="asset-icon {{ asset.type|get_type_class }}">
                                    <i class="fas {{ asset.type|get_type_icon }}"></i>
                                </div>
                            </div>
                            <div class="col">
                                <h2 class="mb-1">{{ asset.name }}</h2>
                                <div class="mb-2">
                                    <span class="badge bg-secondary me-2">{{ asset.type }}</span>
                                    <span class="badge bg-{{ asset.priority|get_priority_color }}">
                                        {{ asset.priority }} PRIORITY
                                    </span>
                                </div>
                                <p class="text-muted mb-0">{{ asset.description or 'Strategic infrastructure asset' }}
                                </p>
                            </div>
                            <div class="col-auto text-end">
                                <div class="badge bg-success fs-6">
                                    <i class="fas fa-shield-alt"></i> MONITORED
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Asset Details -->
        <div class="row">
            <!-- Basic Information -->
            <div class="col-md-6 mb-4">
                <div class="detail-card card h-100">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0">
                            <i class="fas fa-info-circle"></i> Basic Information
                        </h5>
                    </div>
                    <div class="card-body">
                        <table class="table table-borderless">
                            <tr>
                                <td><strong>Asset ID:</strong></td>
                                <td><code>{{ asset_id }}</code></td>
                            </tr>
                            <tr>
                                <td><strong>Name:</strong></td>
                                <td>{{ asset.name }}</td>
                            </tr>
                            <tr>
                                <td><strong>Type:</strong></td>
                                <td>{{ asset.type }}</td>
                            </tr>
                            <tr>
                                <td><strong>Priority Level:</strong></td>
                                <td>
                                    <span class="priority-{{ asset.priority.lower() }}">
                                        <i class="fas fa-circle"></i> {{ asset.priority }}
                                    </span>
                                </td>
                            </tr>
                            <tr>
                                <td><strong>Source File:</strong></td>
                                <td>{{ asset.source_file }}</td>
                            </tr>
                            <tr>
                                <td><strong>Description:</strong></td>
                                <td>{{ asset.description or 'N/A' }}</td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Monitoring Status -->
            <div class="col-md-6 mb-4">
                <div class="detail-card card h-100">
                    <div class="card-header bg-success text-white">
                        <h5 class="mb-0">
                            <i class="fas fa-radar-dish"></i> Monitoring Status
                        </h5>
                    </div>
                    <div class="card-body">
                        <table class="table table-borderless">
                            <tr>
                                <td><strong>Status:</strong></td>
                                <td>
                                    <span class="badge bg-success">
                                        <i class="fas fa-eye"></i> ACTIVE
                                    </span>
                                </td>
                            </tr>
                            <tr>
                                <td><strong>Last Monitored:</strong></td>
                                <td>{{ asset.last_monitored or 'Never' }}</td>
                            </tr>
                            <tr>
                                <td><strong>Current Threat:</strong></td>
                                <td>
                                    <span class="badge bg-warning">
                                        <i class="fas fa-shield-alt"></i> LOW
                                    </span>
                                </td>
                            </tr>
                            <tr>
                                <td><strong>Data Source:</strong></td>
                                <td>Satellite Imagery + Ground Intel</td>
                            </tr>
                            <tr>
                                <td><strong>Next Check:</strong></td>
                                <td>Continuous Monitoring</td>
                            </tr>
                            <tr>
                                <td><strong>Alerts:</strong></td>
                                <td>
                                    <span class="text-success">
                                        <i class="fas fa-check-circle"></i> No Active Alerts
                                    </span>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Geographic Information -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="detail-card card">
                    <div class="card-header bg-info text-white">
                        <h5 class="mb-0">
                            <i class="fas fa-map-marker-alt"></i> Geographic Information
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h6>Coordinates</h6>
                                <p class="text-muted">Asset location and boundaries</p>
                                {% if asset.polygon and hasattr(asset.polygon, 'centroid') %}
                                <ul class="list-unstyled">
                                    <li><strong>Center:</strong> {{ "%.6f"|format(asset.polygon.centroid.y) }}, {{
                                        "%.6f"|format(asset.polygon.centroid.x) }}</li>
                                    <li><strong>Bounds:</strong> {{ asset.polygon.bounds }}</li>
                                </ul>
                                {% else %}
                                <p class="text-muted">Coordinate data not available</p>
                                {% endif %}
                            </div>
                            <div class="col-md-6">
                                <h6>Coverage Area</h6>
                                <p class="text-muted">Monitoring zone specifications</p>
                                <ul class="list-unstyled">
                                    <li><strong>Area:</strong> Classified</li>
                                    <li><strong>Perimeter:</strong> Secured</li>
                                    <li><strong>Access Points:</strong> Monitored</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Threat History -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="detail-card card">
                    <div class="card-header bg-warning text-white">
                        <h5 class="mb-0">
                            <i class="fas fa-history"></i> Threat Assessment History
                        </h5>
                    </div>
                    <div class="card-body">
                        {% if asset.threat_history and asset.threat_history|length > 0 %}
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>Timestamp</th>
                                        <th>Threat Level</th>
                                        <th>Data Source</th>
                                        <th>Details</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for entry in asset.threat_history %}
                                    <tr>
                                        <td>{{ entry.timestamp[:16] if entry.timestamp else 'N/A' }}</td>
                                        <td>
                                            <span class="badge bg-{{ (entry.threat_level or 'LOW')|get_threat_color }}">
                                                {{ entry.threat_level or 'UNKNOWN' }}
                                            </span>
                                        </td>
                                        <td>{{ entry.get('data_source', 'GARUDA') }}</td>
                                        <td>{{ entry.get('details', {}).get('threat_factors', ['Normal monitoring'])[0]
                                            if entry.get('details') else 'Routine assessment' }}</td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                        {% else %}
                        <div class="text-center text-muted py-4">
                            <i class="fas fa-shield-alt fa-3x mb-3"></i>
                            <h6>No Threat History Available</h6>
                            <p>This asset has not been fully monitored yet, or no threats have been detected.</p>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

        <!-- Actions -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="detail-card card">
                    <div class="card-header bg-secondary text-white">
                        <h5 class="mb-0">
                            <i class="fas fa-cogs"></i> Available Actions
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h6>Monitoring Controls</h6>
                                <div class="d-grid gap-2">
                                    <button class="btn btn-primary" onclick="alert('Starting enhanced monitoring...')">
                                        <i class="fas fa-eye"></i> Start Enhanced Monitoring
                                    </button>
                                    <button class="btn btn-info" onclick="alert('Generating detailed report...')">
                                        <i class="fas fa-file-alt"></i> Generate Report
                                    </button>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h6>Analysis Tools</h6>
                                <div class="d-grid gap-2">
                                    <button class="btn btn-success" onclick="alert('Running threat analysis...')">
                                        <i class="fas fa-shield-alt"></i> Run Threat Analysis
                                    </button>
                                    <button class="btn btn-warning" onclick="alert('Updating asset data...')">
                                        <i class="fas fa-sync-alt"></i> Update Asset Data
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>